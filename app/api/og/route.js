import { ImageResponse } from 'next/og';
// App router includes @vercel/og.
// No need to install it.

export const runtime = 'edge';

export async function GET(request) {
	try {
		const { searchParams } = new URL(request.url);

		// ?title=<title>
		const hasTitle = searchParams.has('title');
		const title = hasTitle ? searchParams.get('title')?.slice(0, 100) : 'My default title';

		return new ImageResponse(
			(
				<div style={{ fontFamily: '"League"' }} tw="bg-gray-300 flex h-full border-t-[#1a1f24] border-[25px] pt-[50px]">
					<div tw="flex flex-col md:flex-row w-full py-12 px-4 md:items-center justify-between px-0 py-8">
						<img
							tw="border-r-[#1a1f24] border-2 pr-24"
							alt="House of Giants"
							height={125}
							width={380}
							src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 113 50'%3E%3Cpath fill='%230a0a0a' d='M13.109 50c-1.762-1.684-2.54-3.964-2.928-6.943-1.761 1.762-3.238 2.85-6.943 2.72C.907 43.317.181 39.793.13 35L0 11.243C0 7.098 8.575.337 12.798.337c2.927 0 3.109 1.243 3.187 4.223v8.316c.051 1.813 0 3.756 1.502 4.274l-6.166 5C9.43 20.648 9.43 16.943 9.43 12.876V8.212c0-2.59-1.632-3.704-2.798-3.704l.052 30.388c0 4.612 1.632 5.778 3.238 5.726v-1.373l-.181-9.223c0-1.218-1.762-.518-2.254-.26v-.854l7.98-6.736c.984 1.114 1.036 3.886.906 6.425l.13 10.648c-.078 2.409.906 4.404 2.46 6.243L13.11 50Zm17.798-8.757L25 45.907c-2.46-2.461-3.109-6.036-3.186-10.985l-.207-24.274c.077-2.28-1.425-3.964-3.187-5.518L24.197 0c3.187 2.461 4.145 6.295 3.964 10.518l.259 24.404c-.052 2.436.933 4.43 2.487 6.322Zm15.518 4.69c-1.244-1.244-2.021-2.669-2.461-4.482-2.591 2.02-5.078 4.145-7.021 4.482-2.54 0-3.498-3.239-3.498-6.373V29.3l9.664-7.409-.052-11.036c0-2.72-.648-5.389-3.057-5.466.388 5.077.337 11.943.078 15.336l-7.591 5.337c1.295-3.316.984-9.74.907-16.373 0-3.627 7.979-8.057 12.28-9.482 3.186 2.54 4.093 6.296 4.015 10.596l.13 24.145c-.078 2.41.984 4.482 2.538 6.295l-5.932 4.69Zm-2.928-6.892c-.13-1.243-.259-2.59-.259-4.015l-.078-9.87-2.85 2.072-.129 6.813v1.037c0 2.85 1.192 4.482 3.316 3.963Zm30.13 2.151-5.855 4.611c-2.461-2.41-3.109-5.984-3.238-10.907l-.13-20.077c0-2.928-.518-5.855-3.834-5.855l.207 25.855c-.078 2.46.985 4.481 2.539 6.373l-5.907 4.611c-2.46-2.41-3.108-5.984-3.238-10.907l-.13-24.093c0-2.332-1.424-4.015-3.108-5.518l5.725-5.13c2.072 1.633 3.186 3.705 3.705 6.166L67.047.155c3.108 2.462 4.093 6.296 3.963 10.596l.13 24.093c-.052 2.436 1.01 4.456 2.487 6.348Zm17.461-2.876c-1.295 4.404-6.114 7.461-10 7.461-2.41-2.46-3.057-5.984-3.186-10.907l-.13-22.15H73.11l2.668-2.642h15.337l-2.332 2.668h-4.404l.13 22.15c-.104 3.368 2.953 4.456 6.58 3.42Z'/%3E%3Cpath fill='%230a0a0a' d='M110.57 29.611c1.114 12.591-10.726 16.296-13.239 16.296-4.663 0-2.02-12.85-6.684-13.057l6.633-3.886c5.595-1.037 1.373 11.632 6.243 11.684 4.534-16.684-10.388-13.187-10.725-22.798V8.005C92.72 4.637 100.518.078 104.3.078c7.021 0 2.798 13.886 8.109 13.497l-7.15 5.389C100.647 17.539 104.093 4.3 99.352 4.3v11.036c.13 3.368 10.57 6.762 11.218 14.274Zm-32.643 5-.18-24.067c.05-2.254-1.426-3.912-3.162-5.466L80.311 0c3.16 2.435 4.119 6.244 3.912 10.415l.259 24.196'/%3E%3C/svg%3E"
						/>
						<h2 tw="flex flex-col text-6xl font-bold text-gray-900 text-left pl-24 capitalize">
							<span tw="text-8xl">üìù</span>
							<br />
							{title}
						</h2>
					</div>
				</div>
			),
			{
				width: 1200,
				height: 630,
			}
		);
	} catch (e) {
		console.log(`${e.message}`);
		return new Response(`Failed to generate the image`, {
			status: 500,
		});
	}
}
